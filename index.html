<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Course App</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, doc, setDoc, onSnapshot, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞
        const firebaseConfig = {
            apiKey: "AIzaSyAQJP9v-BI266Eg7BlkXTmtkh81x5ew8oQ",
            authDomain: "my-course-final.firebaseapp.com",
            projectId: "my-course-final",
            storageBucket: "my-course-final.firebasestorage.app",
            messagingSenderId: "837614939877",
            appId: "1:837614939877:web:3846fec761d5c739882e0c"
        };
        
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        const ADMIN_ID = 758556732; 

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        window.DEFAULT_CONFIG = [
            { id: 1, title: "–ú–æ–¥—É–ª—å 1: –í–≤–µ–¥–µ–Ω–∏–µ", deadline: new Date(Date.now() + 86400000).toISOString().slice(0,16) },
            { id: 2, title: "–ú–æ–¥—É–ª—å 2: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞", deadline: new Date(Date.now() + 172800000).toISOString().slice(0,16) },
            { id: 3, title: "–ú–æ–¥—É–ª—å 3: –í–∏–∑—É–∞–ª", deadline: new Date(Date.now() + 259200000).toISOString().slice(0,16) },
            { id: 4, title: "–ú–æ–¥—É–ª—å 4: –¶–≤–µ—Ç –∏ —Å–µ—Ç–∫–∞", deadline: new Date(Date.now() + 345600000).toISOString().slice(0,16) },
            { id: 5, title: "–ú–æ–¥—É–ª—å 5: –®—Ä–∏—Ñ—Ç—ã", deadline: new Date(Date.now() + 432000000).toISOString().slice(0,16) },
            { id: 6, title: "–ú–æ–¥—É–ª—å 6: –ü—Ä–æ—Ç–æ—Ç–∏–ø—ã", deadline: new Date(Date.now() + 518400000).toISOString().slice(0,16) },
            { id: 7, title: "–ú–æ–¥—É–ª—å 7: –¢–µ—Å—Ç—ã", deadline: new Date(Date.now() + 604800000).toISOString().slice(0,16) },
            { id: 8, title: "–ú–æ–¥—É–ª—å 8: –ê–Ω–∏–º–∞—Ü–∏—è", deadline: new Date(Date.now() + 691200000).toISOString().slice(0,16) },
            { id: 9, title: "–ú–æ–¥—É–ª—å 9: –í–µ—Ä—Å—Ç–∫–∞", deadline: new Date(Date.now() + 777600000).toISOString().slice(0,16) },
            { id: 10, title: "–ú–æ–¥—É–ª—å 10: –§–∏–Ω–∞–ª", deadline: new Date(Date.now() + 864000000).toISOString().slice(0,16) }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage –∏–ª–∏ –¥–µ—Ñ–æ–ª—Ç–æ–≤
        window.courseData = { 
            title: localStorage.getItem('courseTitle') || "–¢–≤–æ–π –ü—É—Ç—å", 
            tasks: JSON.parse(localStorage.getItem('courseConfig')) || window.DEFAULT_CONFIG 
        };
        window.userLevel = parseInt(localStorage.getItem('userCurrentLevel')) || 1;

        const init = async () => {
            renderDashboard();

            try {
                const app = initializeApp(firebaseConfig);
                const db = getFirestore(app);
                const auth = getAuth(app);

                const connectToCloud = (user) => {
                    if (!user) return;
                    // –ü—É—Ç—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º (public/data)
                    const courseRef = doc(db, 'artifacts', appId, 'public', 'data', 'course_settings', 'data_doc');
                    
                    onSnapshot(courseRef, (docSnap) => {
                        const statusDot = document.getElementById('status-dot');
                        if(statusDot) {
                            statusDot.classList.remove('bg-red-500', 'bg-gray-500');
                            statusDot.classList.add('bg-green-500', 'shadow-[0_0_10px_#22c55e]');
                        }

                        if (docSnap.exists()) {
                            const data = docSnap.data();
                            if (data.tasks && data.tasks.length > 0) {
                                window.courseData = data;
                                localStorage.setItem('courseConfig', JSON.stringify(data.tasks));
                                localStorage.setItem('courseTitle', data.title);
                                renderDashboard();
                            }
                        }
                    }, (err) => {
                        console.warn("Cloud access restricted:", err.message);
                        document.getElementById('status-dot')?.classList.replace('bg-gray-500', 'bg-red-500');
                    });

                    window.saveToCloudAction = async (tasks, title) => {
                        if (!auth.currentUser) return false;
                        try {
                            await setDoc(courseRef, { tasks, title, updatedAt: new Date().toISOString() });
                            return true;
                        } catch (e) {
                            console.error("Save error:", e);
                            return false;
                        }
                    };
                };

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        connectToCloud(user);
                    } else {
                        document.getElementById('status-dot')?.classList.add('bg-gray-500');
                    }
                });

                const performAuth = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        try {
                            await signInWithCustomToken(auth, __initial_auth_token);
                            return;
                        } catch (e) {}
                    }
                    try {
                        await signInAnonymously(auth);
                    } catch (e) {
                        document.getElementById('status-dot')?.classList.replace('bg-gray-500', 'bg-red-500');
                    }
                };

                await performAuth();

            } catch (e) { 
                document.getElementById('status-dot')?.classList.add('bg-red-500');
            }
        };

        window.onload = init;

        // Telegram WebApp logic
        const tg = window.Telegram?.WebApp;
        if(tg) tg.expand();
        
        let clickCount = 0;
        window.adminClick = () => {
            // –£–ë–†–ê–ù–ê –ü–†–û–í–ï–†–ö–ê ID - —Ç–µ–ø–µ—Ä—å –æ—Ç–∫—Ä—ã—Ç—å –º–æ–∂–µ—Ç –ª—é–±–æ–π –ø–æ 5 –∫–ª–∏–∫–∞–º
            clickCount++;
            if (clickCount >= 5) {
                document.getElementById('admin-btn').classList.remove('hidden');
                document.getElementById('default-icon').classList.add('hidden');
                if(tg && tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
                clickCount = 0;
            }
            
            clearTimeout(window.clickTimer);
            window.clickTimer = setTimeout(() => clickCount = 0, 3000);
        };

        window.toggleAdmin = () => {
            const p = document.getElementById('admin-panel');
            p.classList.toggle('hidden');
            
            if(!p.classList.contains('hidden')) {
                // –ü–†–û–í–ï–†–ö–ê –ü–†–ê–í: –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –ê–¥–º–∏–Ω –∏–ª–∏ –£—á–µ–Ω–∏–∫
                const user = tg?.initDataUnsafe?.user;
                const isAdmin = user && Number(user.id) === Number(ADMIN_ID);
                
                const titleSec = document.getElementById('admin-title-section');
                const inputsSec = document.getElementById('admin-inputs');
                const botControls = document.getElementById('admin-bottom-controls');
                const panelTitle = document.getElementById('admin-panel-title');
                
                if (isAdmin) {
                    // –ê–î–ú–ò–ù: –í–∏–¥–∏—Ç –≤—Å—ë
                    panelTitle.innerText = "–†–ï–î–ê–ö–¢–û–† –ö–£–†–°–ê";
                    titleSec.classList.remove('hidden');
                    inputsSec.classList.remove('hidden');
                    botControls.classList.remove('hidden');
                    
                    document.getElementById('admin-course-title-input').value = window.courseData.title;
                    renderAdminInputs();
                } else {
                    // –£–ß–ï–ù–ò–ö: –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                    panelTitle.innerText = "–ù–ê–°–¢–†–û–ô–ö–ò";
                    titleSec.classList.add('hidden');
                    inputsSec.classList.add('hidden');
                    botControls.classList.add('hidden');
                }
            }
        };

        window.renderAdminInputs = () => {
            const container = document.getElementById('admin-inputs');
            container.innerHTML = window.courseData.tasks.map((t, i) => `
                <div class="p-3 bg-white/5 rounded-xl border border-white/10 relative group">
                    <button onclick="removeModule(${i})" class="absolute top-2 right-2 text-gray-500 hover:text-red-500 p-1 opacity-50 group-hover:opacity-100 transition-all"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                    <input type="text" id="adm-t-${i}" value="${t.title}" class="w-10/12 bg-transparent border-b border-white/10 py-1 text-xs mb-2 outline-none focus:border-yellow-500 transition-colors">
                    <input type="datetime-local" id="adm-d-${i}" value="${t.deadline}" class="w-full bg-white/10 rounded p-2 text-white text-[10px] outline-none">
                </div>
            `).join('');
            if(window.lucide) lucide.createIcons();
        };

        window.addModule = () => {
            window.courseData.tasks.push({ 
                id: Date.now(), 
                title: `–ú–æ–¥—É–ª—å ${window.courseData.tasks.length + 1}`, 
                deadline: new Date(Date.now() + 86400000).toISOString().slice(0,16) 
            });
            window.renderAdminInputs();
        };

        window.removeModule = (i) => {
            if(window.courseData.tasks.length <= 1) return;
            window.showModal("–£–¥–∞–ª–∏—Ç—å?", "–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–æ–¥—É–ª—å?", (ok) => {
                if(ok) {
                    window.courseData.tasks.splice(i, 1);
                    window.renderAdminInputs();
                }
            });
        };

        window.renderDashboard = () => {
            document.getElementById('main-title').innerText = window.courseData.title;
            const container = document.getElementById('tasks-list');
            container.innerHTML = '';
            const completed = Math.min(window.userLevel - 1, window.courseData.tasks.length);
            document.getElementById('progress-counter').innerText = `${completed}/${window.courseData.tasks.length}`;

            window.courseData.tasks.forEach((t, i) => {
                const lvl = i + 1;
                let cls='', icon='', click=false;
                if(lvl < window.userLevel) { 
                    cls='task-done'; 
                    icon='<i data-lucide="check-circle-2" class="text-emerald-400 w-6 h-6"></i>'; 
                } else if(lvl === window.userLevel) { 
                    cls='task-active cursor-pointer hover:bg-white/5'; 
                    icon='<div class="pulse-ring"></div>'; 
                    click=true; 
                } else { 
                    cls='task-locked'; 
                    icon='<i data-lucide="lock" class="text-gray-600 w-5 h-5"></i>'; 
                }
                const d = new Date(t.deadline);
                container.insertAdjacentHTML('beforeend', `
                    <div class="glass-panel p-5 task-card ${cls} animate-in" style="animation-delay: ${i * 0.05}s" onclick="${click ? `openTask(${t.id})` : ''}">
                        <div class="flex flex-col flex-1 pr-4">
                            <span class="text-[9px] text-gray-500 font-bold uppercase tracking-widest mb-1">–≠—Ç–∞–ø ${lvl}</span>
                            <h3 class="text-base font-bold mb-1 leading-tight">${t.title}</h3>
                            <div class="text-[10px] text-gray-400 flex items-center gap-1">
                                <i data-lucide="clock" class="w-3 h-3"></i> ${d.toLocaleDateString('ru-RU')} –≤ ${d.toLocaleTimeString('ru-RU', {hour:'2-digit', minute:'2-digit'})}
                            </div>
                        </div>
                        <div class="w-12 flex items-center justify-center">${icon}</div>
                    </div>
                `);
            });
            if(window.lucide) lucide.createIcons();
        };

        let activeId = null, timer = null;
        window.openTask = (id) => {
            activeId = id;
            const t = window.courseData.tasks.find(x => x.id === id);
            document.getElementById('detail-title').innerText = t.title;
            document.getElementById('screen-detail').classList.remove('hidden');
            const el = document.getElementById('detail-timer');
            const btn = document.getElementById('submit-btn');
            const lBtn = document.getElementById('late-submit-btn');
            document.getElementById('work-url').value = '';
            if(timer) clearInterval(timer);
            const upd = () => {
                const diff = new Date(t.deadline) - new Date();
                if(diff <= 0) { 
                    el.innerText = "00:00:00"; 
                    el.className = "text-3xl font-black neon-red"; 
                    btn.classList.add('hidden'); 
                    lBtn.classList.remove('hidden'); 
                    return; 
                }
                el.className = "text-3xl font-black neon-blue"; 
                btn.classList.remove('hidden'); 
                lBtn.classList.add('hidden');
                const h=Math.floor(diff/3600000), m=Math.floor((diff%3600000)/60000), s=Math.floor((diff%60000)/1000);
                el.innerText = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
            };
            upd(); timer = setInterval(upd, 1000);
        };

        window.goBack = () => { 
            document.getElementById('screen-detail').classList.add('hidden'); 
            clearInterval(timer); 
        };

        window.submitTask = async (late = false) => {
            const urlInp = document.getElementById('work-url');
            const url = urlInp.value.trim();
            if(!url.startsWith('http')) return window.showModal("–û—à–∏–±–∫–∞", "–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Å—ã–ª–∫—É.");
            
            window.showModal("–û—Ç–ø—Ä–∞–≤–∏—Ç—å?", late ? "–í—ã —Å–¥–∞–µ—Ç–µ —Å –æ–ø–æ–∑–¥–∞–Ω–∏–µ–º." : "–°—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—É—Ä–∞—Ç–æ—Ä—É.", async (ok) => {
                if(ok) {
                    const t = window.courseData.tasks.find(x => x.id === activeId);
                    const user = tg?.initDataUnsafe?.user || {first_name: '–¢–µ—Å—Ç', username: 'user', id: '0'};
                    const completed = Math.min(window.userLevel, window.courseData.tasks.length);
                    
                    const msg = `üì¨ <b>–ù–û–í–ê–Ø –†–ê–ë–û–¢–ê</b>\n\n` +
                                `<b>–ò–º—è:</b> ${user.first_name}\n` +
                                `<b>–õ–æ–≥–∏–Ω:</b> @${user.username || 'unknown'}\n\n` +
                                `<b>–°—Å—ã–ª–∫–∞ –Ω–∞ –î–ó:</b> ${url}\n` +
                                `<b>–°—Ç–∞—Ç—É—Å:</b> ${late ? '–ü–æ—Å–ª–µ –¥–µ–¥–ª–∞–π–Ω–∞ üö©' : '–í–æ–≤—Ä–µ–º—è ‚úÖ'}\n` +
                                `<b>–ú–æ–¥—É–ª—å:</b> ${t.title}\n` +
                                `<b>–ü—Ä–æ–≥—Ä–µ—Å—Å:</b> ${completed}/${window.courseData.tasks.length}`;

                    try {
                        await fetch(`https://api.telegram.org/bot8068708797:AAGhY2aD8_waCmB8oCyN2dd3FcmMY3SJJAs/sendMessage`, {
                            method:'POST', headers:{'Content-Type':'application/json'},
                            body: JSON.stringify({chat_id:"758556732", text:msg, parse_mode:'HTML'})
                        });
                        handleSuccess();
                    } catch(e) { handleSuccess(); }
                }
            });
        };

        function handleSuccess() {
            window.userLevel++; 
            localStorage.setItem('userCurrentLevel', window.userLevel);
            window.goBack(); 
            window.renderDashboard();
            window.showModal("–£—Å–ø–µ—à–Ω–æ", "–†–∞–±–æ—Ç–∞ –ø—Ä–∏–Ω—è—Ç–∞!", null, false);
        }

        window.resetUserProgress = () => {
            window.showModal("–°–±—Ä–æ—Å?", "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ 1 —É—Ä–æ–≤–µ–Ω—å?", (ok) => {
                if(ok) { 
                    window.userLevel = 1; 
                    localStorage.setItem('userCurrentLevel', 1); 
                    window.renderDashboard(); 
                    window.toggleAdmin(); 
                }
            });
        };

        window.saveAdminData = async () => {
            const btn = document.getElementById('cloud-save-btn');
            btn.disabled = true; btn.innerText = "–°–û–•–†–ê–ù–ï–ù–ò–ï...";
            const title = document.getElementById('admin-course-title-input').value;
            const tasks = window.courseData.tasks.map((t, i) => ({
                id: t.id || Date.now() + i,
                title: document.getElementById(`adm-t-${i}`).value,
                deadline: document.getElementById(`adm-d-${i}`).value
            }));

            window.courseData.tasks = tasks;
            window.courseData.title = title;
            localStorage.setItem('courseConfig', JSON.stringify(tasks));
            localStorage.setItem('courseTitle', title);
            window.renderDashboard();

            if(window.saveToCloudAction) {
                const ok = await window.saveToCloudAction(tasks, title);
                if(ok) { 
                    window.showModal("–£—Å–ø–µ—à–Ω–æ", "–ö—É—Ä—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –æ–±–ª–∞–∫–µ."); 
                    window.toggleAdmin(); 
                } else {
                    window.showModal("–û—à–∏–±–∫–∞", "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ–±–ª–∞–∫–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞ Firebase.");
                }
            } else {
                window.showModal("–õ–æ–∫–∞–ª—å–Ω–æ", "–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–º—è—Ç–∏. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Firebase –Ω–µ —É–¥–∞–ª–∞—Å—å.");
                window.toggleAdmin();
            }
            btn.disabled = false; btn.innerText = "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –æ–±–ª–∞–∫–æ";
        };

        window.showModal = (t, m, cb = null, showCancel = true) => {
            const el = document.getElementById('custom-modal');
            document.getElementById('modal-title').innerText = t;
            document.getElementById('modal-message').innerText = m;
            const b = document.getElementById('modal-buttons'); b.innerHTML = '';
            const createBtn = (txt, cls, fn) => {
                const bt = document.createElement('button');
                bt.className = `flex-1 py-3 rounded-xl font-bold text-[10px] uppercase tracking-wider ${cls}`;
                bt.innerText = txt; bt.onclick = fn; b.appendChild(bt);
            }
            if(showCancel && cb) createBtn("–û—Ç–º–µ–Ω–∞", "bg-white/5", () => el.classList.add('hidden'));
            createBtn("–û–ö", "bg-blue-600", () => { el.classList.add('hidden'); if(cb) cb(true); });
            el.classList.remove('hidden');
        };
    </script>

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: radial-gradient(circle at top right, #0f172a, #000000); 
            background-attachment: fixed; 
            color: white; 
            min-height: 100vh; 
            overflow-x: hidden; 
            -webkit-tap-highlight-color: transparent; 
            padding-top: env(safe-area-inset-top); 
            padding-bottom: env(safe-area-inset-bottom); 
        }
        .glass-panel { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            border-radius: 20px; 
        }
        .task-card { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
            display: flex; 
            align-items: center; 
        }
        .task-active { 
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(37, 99, 235, 0.1) 100%); 
            border-color: #3b82f6; 
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.15); 
        }
        .task-locked { 
            opacity: 0.5; 
            filter: grayscale(1); 
            pointer-events: none; 
        }
        .task-done { 
            border-color: #10b981; 
            background: rgba(16, 185, 129, 0.08); 
        }
        .neon-text { text-shadow: 0 0 10px rgba(255, 255, 255, 0.2); }
        .neon-blue { text-shadow: 0 0 15px #3b82f6; }
        .neon-red { text-shadow: 0 0 15px #ef4444; color: #ef4444 !important; }
        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(15px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .animate-in { animation: slideUp 0.4s ease-out forwards; }
        .pulse-ring { 
            width: 12px; height: 12px; 
            background: #3b82f6; 
            border-radius: 50%; 
            animation: pulse-blue 2s infinite; 
        }
        @keyframes pulse-blue { 
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); } 
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); } 
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); } 
        }
    </style>
</head>
<body class="p-4 sm:p-6 flex justify-center">

    <div class="w-full max-w-md mx-auto flex flex-col h-full relative">
        <!-- Dashboard Screen -->
        <div id="screen-dashboard" class="w-full pb-10">
            <header class="mb-6 flex justify-between items-end sticky top-0 z-10 py-4 bg-black/40 backdrop-blur-md -mx-4 px-4 rounded-b-2xl">
                <div onclick="adminClick()" class="flex flex-col cursor-pointer select-none">
                    <div class="flex items-center gap-2">
                        <h1 id="main-title" class="text-xl font-extrabold tracking-tight neon-text truncate max-w-[200px]">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
                        <div id="status-dot" class="w-2.5 h-2.5 rounded-full bg-gray-500 transition-all duration-500 flex-shrink-0"></div>
                    </div>
                    <p class="text-gray-400 text-[10px] mt-0.5">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: <span id="progress-counter" class="text-white font-bold">0/0</span></p>
                </div>
                <button id="admin-btn" onclick="toggleAdmin()" class="hidden w-9 h-9 rounded-full bg-yellow-500/20 border border-yellow-500/40 flex items-center justify-center animate-bounce">
                    <i data-lucide="settings" class="text-yellow-500 w-4 h-4"></i>
                </button>
                <div id="default-icon" class="w-10 h-10 rounded-full bg-blue-900/20 flex items-center justify-center border border-blue-500/20">
                    <i data-lucide="layout" class="text-blue-400 w-5 h-5"></i>
                </div>
            </header>
            <div id="tasks-list" class="space-y-3"></div>
        </div>

        <!-- Detail Screen / Modal -->
        <div id="screen-detail" class="hidden fixed inset-0 z-50 bg-black/80 backdrop-blur-sm p-6 flex items-center justify-center animate-in">
            <div class="glass-panel p-6 w-full max-w-[340px] relative shadow-2xl">
                <button onclick="goBack()" class="absolute -top-12 left-0 text-gray-400 flex items-center gap-2 text-sm hover:text-white transition-colors">
                    <i data-lucide="arrow-left" class="w-4 h-4"></i> –ù–∞–∑–∞–¥
                </button>
                <h2 id="detail-title" class="text-lg font-bold mb-1 text-center text-blue-400 uppercase tracking-wider"></h2>
                <div class="flex flex-col items-center mb-6">
                    <span class="text-[9px] uppercase tracking-[0.2em] text-gray-500 mb-1 text-center">–î–µ–¥–ª–∞–π–Ω –º–æ–¥—É–ª—è</span>
                    <div id="detail-timer" class="text-3xl font-black tabular-nums neon-blue">00:00:00</div>
                </div>
                <div class="space-y-4">
                    <div class="space-y-1">
                        <label class="text-[10px] text-gray-400 uppercase ml-1">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∞–±–æ—Ç—É</label>
                        <input type="url" id="work-url" placeholder="https://..." class="w-full px-4 py-3 rounded-xl text-white bg-black/40 border border-gray-800 focus:border-blue-500 outline-none text-sm placeholder-gray-600">
                    </div>
                    <div id="buttons-container" class="space-y-2">
                        <button id="submit-btn" onclick="submitTask()" class="w-full py-3.5 rounded-xl font-bold uppercase tracking-wider text-[11px] bg-blue-600 active:scale-95 transition-all">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É</button>
                        <button id="late-submit-btn" onclick="submitTask(true)" class="hidden w-full py-3.5 rounded-xl font-bold uppercase tracking-wider text-[11px] bg-red-600/20 text-red-500 border border-red-500/40 active:scale-95 transition-all">–°–¥–∞—Ç—å —Å –æ–ø–æ–∑–¥–∞–Ω–∏–µ–º</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel" class="hidden fixed inset-0 z-[60] bg-slate-950 p-6 overflow-y-auto">
        <div class="w-full max-w-md mx-auto pb-48">
            <div class="flex justify-between items-center mb-6">
                <h2 id="admin-panel-title" class="text-xl font-bold text-yellow-500 uppercase">–†–µ–¥–∞–∫—Ç–æ—Ä –∫—É—Ä—Å–∞</h2>
                <button onclick="toggleAdmin()" class="px-3 py-1 bg-white/10 rounded-lg text-xs">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ê–î–ú–ò–ù–ê: –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div id="admin-title-section" class="mb-4 p-4 bg-white/5 rounded-xl border border-white/10">
                <label class="text-[10px] text-yellow-500 font-bold uppercase block mb-1">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫—É—Ä—Å–∞</label>
                <input type="text" id="admin-course-title-input" class="w-full bg-transparent border-b border-white/20 py-1 text-base font-bold text-white outline-none">
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ê–î–ú–ò–ù–ê: –°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π -->
            <div id="admin-inputs" class="space-y-3 mb-6"></div>
            
            <!-- –°–µ–∫—Ü–∏—è –û–ë–©–ê–Ø: –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
            <div class="p-4 bg-red-500/10 rounded-xl border border-red-500/20 mb-10">
                <button onclick="resetUserProgress()" class="w-full py-3 bg-red-600 rounded-xl text-[10px] font-bold uppercase tracking-widest text-white">–°–±—Ä–æ—Å–∏—Ç—å –º–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ê–î–ú–ò–ù–ê: –ù–∏–∂–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ -->
            <div id="admin-bottom-controls" class="fixed bottom-0 left-0 w-full p-4 bg-slate-950/90 backdrop-blur-md border-t border-white/10 flex flex-col gap-2 max-w-md mx-auto right-0">
                 <button onclick="addModule()" class="py-3 bg-white/5 rounded-xl text-xs font-bold uppercase tracking-widest">+ –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å</button>
                 <button id="cloud-save-btn" onclick="saveAdminData()" class="py-4 bg-yellow-600 rounded-xl font-bold text-black uppercase text-xs tracking-widest">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –æ–±–ª–∞–∫–æ</button>
            </div>
        </div>
    </div>

    <!-- Custom Dialog Modal -->
    <div id="custom-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center bg-black/90 p-6 backdrop-blur-md animate-in">
        <div class="glass-panel p-6 w-full max-w-xs text-center">
            <h3 id="modal-title" class="text-lg font-bold mb-2"></h3>
            <p id="modal-message" class="text-gray-400 mb-6 text-xs"></p>
            <div id="modal-buttons" class="flex gap-2"></div>
        </div>
    </div>
</body>
</html>
